# 1.1.5 프록시 패턴과 프록시 서버

프록시 객체: 디자인 패턴 중 하나인 프록시 패턴이 녹아들어 있는 객체


---


### 프록시 패턴

대상 객체에 접근하기 전 접근에 대한 흐름을 가로채 해당 접근을 필터링하거나 수정하는 등의 역할을 하는 계층이 있는 디자인 패턴

객체의 속성, 변환 등을 보완하며 보안, 데이터 검증, 캐싱, 로깅에 사용

프록시 객체로 쓰이기도 하지만 프록시 서버로도 활용



### 📖 용어 - 프록시 서버에서의 캐싱

> 💡 캐시 안에 정보를 담아두고, 캐시 안에 있는 정보를 요구하는 요청에 대해  
> 다시 저 멀리 있는 원격 서버에 요청하지 않고 캐시 안에 있는 데이터를 활용하는 것  
> → 불필요하게 외부와 연결하지 않기 때문에 트래픽을 줄일 수 있다는 장점


---


### 프록시 서버

서버와 클라이언트 사이에서 클라이언트가 자신을 통해 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해주는 컴퓨터 시스템이나 응용 프로그램



### 프록시 서버로 쓰는 nginx

- 비동기 이벤트 기반의 구조와 다수의 연결을 효과적으로 처리 가능한 웹 서버  
- 주로 Node.js 서버 앞단이 프록시 서버로 활용  

> “You just may be hacked when some yet-known buffer overflow is discovered.  
> Not that couldn’t happend behind nginx, but somehow having a proxy in front makes me happy.”  
> – Ryan Dahl

- Node.js 서버를 구축할 때 앞단에 프록시 서버로 nginx를 두고 Node.js를 뒤쪽에 놓는 것이 좋음  
- 익명 사용자가 직접적으로 서버에 접근하는 것을 차단하고, 간접적으로 한 단계를 더 거치게 만들어 보안을 강화 가능  
- nginx를 프록시 서버로 둬서 실제 포트를 숨길 수 있고, 정적 자원을 gzip 압축하거나, 메인 서버 앞단에서의 로깅 가능



### 📖 용어 - 버퍼 오버플로우

> 💡 **버퍼** : 보통 데이터가 저장되는 메모리 공간  
> 💥 **버퍼 오버플로우** : 메모리 공간을 벗어나는 경우  
> → 이때 사용되지 않아야 할 영역에 데이터가 덮어씌워져 주소, 값을 바꾸는 공격이 발생하기도 함



### 📖 용어 - gzip 압축

> 💡 LZ77과 Huffman 코딩의 조합인 **DEFLATE 알고리즘**을 기반으로 한 압축 기술  
> → gzip 압축을 하면 **데이터 전송량을 줄일 수 있지만**,  
> **압축을 해제했을 때 서버에서의 CPU 오버헤드**도 생각해서 gzip 압축 사용 유무를 결정해야 함



### 프록시 서버로 쓰는 CloudFlare

- **전 세계적으로 분산된 서버**가 있고, 이를 통해 어떠한 시스템의 **콘텐츠 전달을 빠르게 할 수 있는 CDN 서비스**
- 웹 서버 앞단에 프록시 서버로 두어 **DDOS 공격 방어**나 **HTTPS 구축**에 사용
- 해외에서 의심스러운 트래픽이 많이 발생하면 많은 클라우드 서비스 비용 발생 가능
- CloudFlare가 먼저 판단해 CAPTCHA 등을 기반으로 위와 같은 상황을 일정 부분 막아주기도 함

**DDOS 공격 방어**
- **DDOS**: 짧은 시간 동안 네트워크에 많은 요청을 보내 **네트워크를 마비**시키는 사이버 공격  
- CloudFlare는 시스템을 통해 오는 트래픽을 자동으로 차단해 DDOS 공격으로부터 보호

**HTTPS 구축**
- CloudFlare를 사용해 **별도의 인증서 설치 없이** 좀 더 손쉽게 HTTPS 구축 가능



### 📖 용어 - CDN (Content Delivery Network)

> 💡 각 사용자가 인터넷에 접속하는 곳과 가까운 곳에서 콘텐츠를 캐싱 또는 배포하는 서버 네트워크  
> → 사용자가 웹 서버로부터 콘텐츠를 다운로드하는 시간을 줄일 수 있음


---


### CORS와 프론트엔드의 프록시 서버

**CORS (Cross-Origin Resource Sharing)**  
: 서버가 웹 브라우저에서 리소스를 로드할 때 **다른 오리진을 통해 로드하지 못하게 하는 HTTP 헤더 기반 메커니즘**

- 프론트엔드 개발 시 프론트엔드 서버를 만들어서 백엔드 서버와 통신할 때 주로 CORS 에러를 마주침  
- 이를 해결하기 위해 프론트엔드에서 **프록시 서버**를 만들기도 함  
- 예시:
  - 프론트엔드: 127.0.0.1:3000  
  - 백엔드: 127.0.0.1:12010  
  → 포트 번호가 다르므로 **CORS 에러 발생**

- 프록시 서버를 둬서 프론트엔드 서버에서 요청되는 오리진을 백엔드 포트 번호로 변경



### 📖 용어 - 오리진

> 💡 **프로토콜**, **호스트 이름**, **포트**의 조합  
> 예: `https://kundol.com:12010/test` → `https://kundol.com:12010`



### 📖 루프백(loopback) IP

본인 PC 서버의 IP

localhost, 127.0.0.1을 주소창에 입력하면 DNS를 거치지 않고 바로 본인 PC 서버로 연결
