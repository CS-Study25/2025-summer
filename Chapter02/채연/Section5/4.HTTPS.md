# HTTPS
    HTTPS = HTTP + TLS (HTTP에 보안 계층이 추가된 것)
## 개념
- HTTPS는 애플리케이셔 계층과 전송 계층 사이에 신뢰 계층인 SSL/TLS 계층을 넣은 신뢰할 수 있는 HTTP 요청을 말한다. 
    - 이를 통해 통신을 암호화 한다. 
- 대부분의 브라우저에서 HPPT/2을 사용하려면 반드시 HTTPS을 통해야한다. 

## 1. SSL / TLS
    SSL은 과거에 쓰였던 보안 프로토콜이고, TLS는 후속 버전 (현재 사용) 프로토콜이다. 
- 둘 다 전송 계층에서 보안을 제공하는 프로토콜이다. 
- SSL에 여러 보안 취약점이 발견되어 현재는 TLS을 쓴다. 
- 클라이언트와 서버가 통신할 때 SSL/TLS을 통해 메시지 도청,변조 등을 막는다. 
- 보안 세션이 만들어질 때 인증 메커니즘, 키 교환 암호화 알고리즘, 해싱 알고리즘이 사용된다. 

#### 보안 세션
    보안이 시작되고 끝나는 동안 유지되는 세션
- SSL/TLS은 핸드셰이크를 통해 보안 세션을 생성하고 이를 기반으로 상태 정보 등을 공유한다. 

#### TLS 핸드셰이크
    클라이언트와 서버가 안전한 통신을 시작하기 전 암호화에 사용할 키를 교환하고 신뢰를 확인하는 과정
- ClientHello (클라이언트 -> 서버)
    - 클라이언트의 요청: “안녕! 나는 이런 암호화 알고리즘들(cypher suites)을 쓸 수 있고,
이건 내 공개키 조각(KeyShare)이야. 너랑 안전하게 대화하고 싶어!”
- ServerHello (서버 -> 클라이언트)
    - 서버의 응답: “좋아, 나도 그 알고리즘 중 이걸 쓸게!
그리고 이건 내 공개키 조각이야.”
    - 클라이언트와 서버의 암호화 알고리즘 합의 (어떤 암호화 알고리즘으로 소통할지 결정)
- EncryptedExtensions
    - 서버가 추가적인 TLS 확장 설정을 암호화된 상태로 전송 (클라이언트 인증 필요 여부 등)
- Certificate + CertificateVerify
    - 서버는 자신이 진짜라는 것을 증명하기 위해 SSL/TLS 인증서를 보냄
        - (보통은 CA로부터 발급받은 공개키 기반 인증서)
	- 그리고 CertificateVerify 단계에서,
	“이 인증서가 진짜 내 거라는 증거”로 개인키로 서명한 메시지를 보냄
- Finished(Server)
    - 서버 인증 완료
    - 서버가 “나 인증 끝났어!”라고 알려줌
    - 이 시점부터 세션 키로 암호화된 데이터 송수신 가능
- Finished (Client)
    - 클라이언트도 인증 완료
- Application Data
    - 이 시점부터 안전한 암호화 통신 시작

## 2. 사이퍼 슈트
    보안 프로토콜에 사용되는 암호 알고리즘들의 조합
- 어떻게 안전하게 통신할지를 정한 암호화 기술 세트 
    - 프로토콜, AEAD 사이퍼모드, 해싱 알고리즘이 나열된 규약
#### cf) 언제 사이퍼 슈트를 선택하는지? 
    TLS 핸드셰이크 시,
        1.	클라이언트가 지원 가능한 cipher suite 목록을 서버에 보냄
        2.	서버가 그 중 하나를 선택해서 통신 방식 통일
        → 이후 통신은 선택된 cipher suite 기준으로 세션 키 생성 → 암호화 전송 시작
## 3. AEAD 사이퍼 모드 
    데이터 암호화 알고리즘이다. 

#### 인증 메커니즘
    CA에서 발급한 인증서를 기반으로 인증 메커니즘이 이루어진다. 
- 서버는 CA에서 발급 받은 인증서를 클라이언트에 제공한다. 
- 브라우저는 이 인증서를 보고 해당 서버를 신뢰한다. 
- 인증서에는 공개키, 서버 정보, 지문, 디지털 서명 등이 있다.

## 4. 암호화 알고리즘: 디피-헬만 키 교환 암호화 알고리즘
    서로 키를 주고받지 않아도, 같은 비밀키를 만들어내는 알고리즘
- 암호화를 위해서는 같은 비밀키가 필요한데 그걸 직접 주고받으면 탈취될 수 있으므로, 직접 주고받지 않고도 같은 키를 만들어내는 방법이 필요했음

## 5. 해싱 알고리즘
    어떤 길이의 데이터든 상관없이,
    항상 고정된 길이의 문자열(해시 값)로 변환해주는 수학적 알고리즘
- 데이터를 추정하기 힘들게 만드는 알고리즘
- SHA-256 알고리즘, SHA-384 알고리즘이 있다. 
#### SHA-256알고리즘
    해시 함수의 결과값이 256비트인 알고리즘

## 6. HTTPS 구축 방법
    1. 직접 CA에서 구매한 인증키를 기반으로 HTTPS 서비스 구축
    2. 서버 앞단의 HTTPS을 제공하는 로드 밸런서를 둠
    3. 서버 앞단에 HTTPS을 제공하는 CDN을 둬서 구축